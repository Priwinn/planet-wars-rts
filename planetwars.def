Bootstrap: docker
From: gradle:8.4.0-jdk20

%post
    # Create working directory
    mkdir -p /build
    cd /build

    # Build the jar (assumes Gradle project structure in /build)
    gradle :app:build -x test

    # Copy output to run location
    mkdir -p /app
    cp /build/app/build/libs/*.jar /app/app.jar

%files
    . /build

%environment
    export JAVA_HOME=/opt/java/openjdk
    export PATH=$JAVA_HOME/bin:$PATH

%runscript
    exec java -jar /app/app.jar
